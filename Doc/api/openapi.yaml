openapi: 3.0.3
info:
  title: ChronoAtlas API
  version: 0.1.0
servers:
  - url: http://localhost:3000
paths:
  /health:
    get:
      summary: Health check
      responses:
        "200":
          description: OK
  /api/hello:
    get:
      summary: Hello endpoint
      responses:
        "200":
          description: OK
  /auth/login:
    post:
      summary: Login
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                email:
                  type: string
                password:
                  type: string
      responses:
        "200":
          description: OK
  /auth/me:
    get:
      summary: Current user
      security:
        - BearerAuth: []
      responses:
        "200":
          description: OK
  /auth/logout:
    post:
      summary: Logout
      security:
        - BearerAuth: []
      responses:
        "200":
          description: OK
  /events:
    get:
      summary: List events
      parameters:
        - in: query
          name: timeFrom
          schema:
            type: integer
        - in: query
          name: timeTo
          schema:
            type: integer
        - in: query
          name: tagIds
          schema:
            type: string
        - in: query
          name: categoryIds
          schema:
            type: string
      responses:
        "200":
          description: OK
    post:
      summary: Create event
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Event"
      responses:
        "201":
          description: Created
  /events/search:
    get:
      summary: Search events
      parameters:
        - in: query
          name: q
          schema:
            type: string
      responses:
        "200":
          description: OK
  /events/aggregations:
    get:
      summary: Event aggregations
      responses:
        "200":
          description: OK
  /events/{id}:
    get:
      summary: Get event by id
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "200":
          description: OK
    patch:
      summary: Update event
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "200":
          description: OK
    delete:
      summary: Delete event
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "204":
          description: No Content
  /events/{id}/versions:
    get:
      summary: Event versions
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "200":
          description: OK
  /events/{id}/restore:
    post:
      summary: Restore event version
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "200":
          description: OK
  /tags:
    get:
      summary: List tags
      responses:
        "200":
          description: OK
    post:
      summary: Create tag
      security:
        - BearerAuth: []
      responses:
        "201":
          description: Created
  /tags/{id}:
    patch:
      summary: Update tag
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "200":
          description: OK
    delete:
      summary: Delete tag
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "204":
          description: No Content
  /categories:
    get:
      summary: List categories
      responses:
        "200":
          description: OK
    post:
      summary: Create category
      security:
        - BearerAuth: []
      responses:
        "201":
          description: Created
  /categories/{id}:
    patch:
      summary: Update category
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "200":
          description: OK
    delete:
      summary: Delete category
      security:
        - BearerAuth: []
      parameters:
        - in: path
          name: id
          required: true
          schema:
            type: string
      responses:
        "204":
          description: No Content
  /import/events:
    post:
      summary: Import events
      security:
        - BearerAuth: []
      responses:
        "200":
          description: OK
  /export/events:
    get:
      summary: Export events
      responses:
        "200":
          description: OK
components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
  schemas:
    EventTime:
      type: object
      properties:
        start:
          type: object
        end:
          type: object
        precision:
          type: string
        fuzzy:
          type: object
    Event:
      type: object
      properties:
        id:
          type: string
        title:
          type: string
        summary:
          type: string
        time:
          $ref: "#/components/schemas/EventTime"
        tagIds:
          type: array
          items:
            type: string
        categoryIds:
          type: array
          items:
            type: string
        createdAt:
          type: string
        updatedAt:
          type: string
    Tag:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
    Category:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
    UserPublic:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        email:
          type: string
        role:
          type: string
    Error:
      type: object
      properties:
        code:
          type: string
        message:
          type: string
        details:
          type: object
